---
title: "Projet Série Temporelle"
output: html_notebook
---
SCHULTZ Martin - Master SISE - Université Lyon 2 <br>
Janvier 2023


Utilisation des librairies nécessaires
```{r}
library("readxl")
library("forecast")
library("fpp2")
library("ggplot2")
library("dplyr")
```


## Importation des données
(Modification de la première cellule via excel pour avoir le boin format de données)
```{r}
data = read_excel("Elec-train.xlsx")
```


La fréquence est de 96 car les données ont été mesuré toutes les 15min. 
1jour = 96 * 15min
```{r}
data=mutate(data, Timestamp = as.POSIXct(Timestamp,format = "%m/%d/%Y %H:%M"))
elec<-ts(data[1:4507,2],start=c(1,1),freq=96)
elecTemperature=ts(data[1:4507,2:3],start=c(1,5),freq=96)
#print(elec)
```



```{r}
plot(elecTemperature)
plot(elec)
```
Il semble avoir une saisonalité dans la consommation électrique, 
Mais il ne semble pas qu'il existe une tendance, car la consommation électrique ne semble ni augmenter ni diminiuer.


Division des données en échantillons d'apprentissage et de test.
L'échantillon de test représente le dernier jour de consommation.
```{r}
elec_train = window(elec, start=c(1,6), end=c(45,96))
elec_test = window(elec, start=c(46,1), end=c(46,96))
elec_prev = window(elec, start=c(1,6), end=c(47,96))

elecTemperature_train = window(elecTemperature, start=c(1,6), end=c(45,96))
elecTemperature_test = window(elecTemperature, start=c(46,1), end=c(46,96))
elecTemperature_prev = window(elecTemperature, start=c(1,6), end=c(47,96))
```
On commence la série à partir de 6 car la première valeur à été prise à 1h15. 








## SARIMA

```{r}
fitAuto=auto.arima(elec_train,lambda = "auto")
summary(fitAuto)
```
```{r}
prev= forecast(fitAuto)
cat("RMSE", sqrt(mean(elec_test-prev$mean)^2))
```
```{r}
autoplot(prev) + autolayer(elec_test, series="True data")+ autolayer(prev$mean, series="Auto Sarima Prediction")
```


```{r}
tmp=acf(elec_train,type="cor",plot = FALSE)
plot(tmp)
```

```{r}
tmp=pacf(elec_train,type="cor",plot = FALSE)
plot(tmp)
```

```{r}
tmp=diff(elec_train,lag=96)
autoplot(tmp)
ggseasonplot(tmp)
```


```{r}
pacf(fitAuto$residuals)
```
```{r}
checkresiduals(fitAuto)

```



















## NEURAL NETWORK

```{r}
NNfit=nnetar(elec_train)
summary(NNfit)
prevNNfit= forecast(NNfit)
cat("RMSE", sqrt(mean(elec_test-prevNNfit$mean)^2))
```










```{r}
fit404=Arima(elec, order=c(4,0,4), seasonal=c(0,1,0))
summary(fit404)
prevfit404= forecast(fit404)
cat("RMSE", sqrt(mean(elec_test-prevfit404$mean)^2))
```

```{r}
fit900=Arima(elec_train, order=c(9,0,0), seasonal=c(0,1,3))
summary(fit900)
prevfit900= forecast(fit900)
cat("RMSE", sqrt(mean(elec_test-prevfit900$mean)^2))

```








## Holt-Winters


```{r}
fitHW= HoltWinters(elec_train)
summary(fitHW)
prevfitHW= forecast(fitHW)
cat("RMSE", sqrt(mean(elec_test-prevfitHW$mean)^2))
```


## Prévisions









Vous devez rendre deux prévisions, avec et sans utilisation de la température extérieure, dans un fichier Excel intitulé

VotreNom.xlsx, avec exactement deux colonnes et 96 lignes, contenant les prévisions pour le 17/02/2010 : la première
colonne pour la prévision sans utilisation de la température, la seconde pour la prévision avec utilisation de la température.

En plus de vos prévisions, vous devez également renvoyer un court rapport (intitulé VotreNom.pdf) expliquant la manière dont vous avez procédé et contenant les codes R.

La notation prendra en compte :
- la qualité de votre méthodologie (50%)
- la qualité de votre prévision (30%)
- la qualité de votre rapport et le respect des consignes de l'examen (20%)